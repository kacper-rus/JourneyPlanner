(function(){"use strict";var e={3595:function(e,t,o){var s=o(525),n=o(3396),r=o(7139);const l={class:"app-header"},a={class:"navbar navbar-expand-sm navbar-dark",style:{"background-color":"Transparent",color:"white"}},i=(0,n._)("a",{class:"navbar-brand",href:"logo"},"LOGO",-1),u={class:"navbar-nav ml-auto"},c={class:"nav-item"},d=(0,n._)("span",{class:"sr-only"},"(current)",-1),g={key:0,class:"nav-item"},p={class:"nav-item"},h={class:"content-wrapper"};function m(e,t,o,s,m,y){const v=(0,n.up)("router-link"),_=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("header",l,[(0,n._)("nav",a,[i,(0,n._)("ul",u,[(0,n._)("li",c,[(0,n.Wm)(v,{class:"nav-link",to:"/"},{default:(0,n.w5)((()=>[(0,n.Uk)("Journey Planner "),d])),_:1})]),m.loggedIn?((0,n.wg)(),(0,n.iD)("li",g,[(0,n.Wm)(v,{class:"nav-link",to:"/dashboard"},{default:(0,n.w5)((()=>[(0,n.Uk)("Dashboard")])),_:1})])):(0,n.kq)("",!0),(0,n._)("li",p,[(0,n.Wm)(v,{class:"nav-link",to:"/login"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(m.logoutMsg),1)])),_:1})])])])]),(0,n._)("div",h,[(0,n.Wm)(_,{loggedIn:m.loggedIn,userID:m.userID,onHandleLogoutApp:y.handleLogoutApp,onCheckLoggedInApp:y.checkLoggedInApp},null,8,["loggedIn","userID","onHandleLogoutApp","onCheckLoggedInApp"])])],64)}o(7658);const y=e=>((0,n.dD)("data-v-69354a8f"),e=e(),(0,n.Cn)(),e),v={key:0,class:"container"},_=y((()=>(0,n._)("div",{class:"speedometer-title"},[(0,n._)("h2",null,"User Feedback Scale")],-1))),w=y((()=>(0,n._)("div",{class:"globalRanking-table-title"},[(0,n._)("h2",null,"Global Ranking Table")],-1))),f={class:"globalRankingTable"},b=y((()=>(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"Rank"),(0,n._)("th",null,"User ID"),(0,n._)("th",null,"CO2 Output")])],-1))),D=y((()=>(0,n._)("div",{class:"individual-statistics-title"},[(0,n._)("h2",null,"User Statistical Readings")],-1))),I={class:"statistics-container"},k=y((()=>(0,n._)("div",{class:"statistic"},[(0,n._)("h4",null,"Average CO2 Output Per Journey"),(0,n._)("p",null,"15")],-1))),S={class:"statistic"},G=y((()=>(0,n._)("h4",null,"Total CO2 Output",-1))),M=y((()=>(0,n._)("div",{class:"statistic"},[(0,n._)("h4",null,"Most Common Mode of Transport"),(0,n._)("p",null,"Car")],-1))),T=y((()=>(0,n._)("div",{class:"statistic"},[(0,n._)("h4",null,"Least Common Mode of Transport"),(0,n._)("p",null,"Train")],-1))),C={class:"statistics-container"},O=y((()=>(0,n._)("div",{class:"statistic"},[(0,n._)("h4",null,"Average CO2 Output Per Mile"),(0,n._)("p",null,"4")],-1))),x=y((()=>(0,n._)("div",{class:"statistic"},[(0,n._)("h4",null,"Average Journey Length"),(0,n._)("p",null,"30 Miles")],-1))),E={class:"statistic"},U=y((()=>(0,n._)("h4",null,"Total Journey Count",-1))),B=y((()=>(0,n._)("div",{class:"statistic"},[(0,n._)("h4",null,"Total Distance Travelled"),(0,n._)("p",null,"300 Miles")],-1))),A={key:1,class:"container"},j=y((()=>(0,n._)("div",{class:"groupRanking-table-title"},[(0,n._)("h2",null,"Group Ranking Table")],-1))),N={class:"groupRankingTable"},R=y((()=>(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"Rank"),(0,n._)("th",null,"User ID"),(0,n._)("th",null,"Username"),(0,n._)("th",null,"CO2 Output")])],-1))),L=y((()=>(0,n._)("div",{class:"group-statistics-title"},[(0,n._)("h2",null,"Group Statistical Readings")],-1))),P={class:"statistics-container"},q={class:"statistic"},z=y((()=>(0,n._)("h4",null,"Average CO2 Output Per Member",-1))),F={class:"statistic"},J=y((()=>(0,n._)("h4",null,"Group Total CO2 Output",-1))),H={class:"statistic"},Y=y((()=>(0,n._)("h4",null,"Group Total Distance Travelled",-1))),W={class:"statistics-container"},K={class:"statistic"},Z=y((()=>(0,n._)("h4",null,"Group Average CO2 Output Per Km",-1))),$={class:"statistic"},V=y((()=>(0,n._)("h4",null,"Average Journey Length",-1))),X={class:"statistic"},Q=y((()=>(0,n._)("h4",null,"Group Total Journey Count",-1)));function ee(e,t,o,s,l,a){const i=(0,n.up)("vue-speedometer");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("a",{class:"dashboard-item",onClick:t[0]||(t[0]=e=>l.currTab="Tab1")},"Individual"),(0,n._)("a",{class:"dashboard-item",onClick:t[1]||(t[1]=e=>l.currTab="Tab2")},"Group"),"Tab1"==l.currTab?((0,n.wg)(),(0,n.iD)("div",v,[_,(0,n.Wm)(i,{width:500,needleHeightRatio:.7,value:this.loggedUserData.distance&&this.loggedUserData.co2Output?100*(this.loggedUserData.co2Output/this.loggedUserData.distance).toFixed(2):0,segmentColors:["limegreen","yellowgreen","gold","orange","tomato"],currentValueText:"CO2 Output",customSegmentLabels:[{text:"Very Good",position:"INSIDE",color:"#555",fontSize:"15px"},{text:"Good",position:"INSIDE",color:"#555",fontSize:"15px"},{text:"Ok",position:"INSIDE",color:"#555",fontSize:"15px"},{text:"Bad",position:"INSIDE",color:"#555",fontSize:"15px"},{text:"Very Bad",position:"INSIDE",color:"#555",fontSize:"15px"}],ringWidth:47,needleTransitionDuration:3333,needleTransition:"easeElastic",needleColor:"steelblue",textColor:"steelblue"},null,8,["needleHeightRatio","value"]),w,(0,n._)("table",f,[b,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.journeyArray,((e,t)=>((0,n.wg)(),(0,n.iD)("tr",{key:t,class:(0,r.C_)({"highlight-row":e.userID===l.highlightUserID})},[(0,n._)("td",null,(0,r.zw)(t+1),1),(0,n._)("td",null,(0,r.zw)(e.userID),1),(0,n._)("td",null,(0,r.zw)(e.co2Output),1)],2)))),128))])]),D,(0,n._)("div",I,[k,(0,n._)("div",S,[G,(0,n._)("p",null,(0,r.zw)(this.loggedUserData.co2Output?this.loggedUserData.co2Output:0),1)]),M,T]),(0,n._)("div",C,[O,x,(0,n._)("div",E,[U,(0,n._)("p",null,(0,r.zw)(Object.keys(this.loggedUserJourneys).length?Object.keys(this.loggedUserJourneys).length:0),1)]),B])])):((0,n.wg)(),(0,n.iD)("div",A,[j,(0,n._)("table",N,[R,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.cumulativeGroupJourneys,((e,t)=>((0,n.wg)(),(0,n.iD)("tr",{key:t,class:(0,r.C_)({"highlight-row":e.userID===l.highlightUserID})},[(0,n._)("td",null,(0,r.zw)(t+1),1),(0,n._)("td",null,(0,r.zw)(e.userID),1),(0,n._)("td",null,(0,r.zw)(e.username),1),(0,n._)("td",null,(0,r.zw)(e.co2Output),1)],2)))),128))])]),L,(0,n._)("div",P,[(0,n._)("div",q,[z,(0,n._)("p",null,(0,r.zw)(this.totalGroupCo2Output?(this.totalGroupCo2Output/this.cumulativeGroupJourneys.length).toFixed(2):0),1)]),(0,n._)("div",F,[J,(0,n._)("p",null,(0,r.zw)(this.totalGroupCo2Output?this.totalGroupCo2Output:0),1)]),(0,n._)("div",H,[Y,(0,n._)("p",null,(0,r.zw)(this.totalGroupDistance?this.totalGroupDistance:0)+" Km",1)])]),(0,n._)("div",W,[(0,n._)("div",K,[Z,(0,n._)("p",null,(0,r.zw)(this.totalGroupCo2Output&&this.totalGroupCo2Output?(this.totalGroupCo2Output/this.totalGroupDistance).toFixed(2):0),1)]),(0,n._)("div",$,[V,(0,n._)("p",null,(0,r.zw)((this.totalGroupDistance/this.loggedGroupJourneys.length).toFixed(2)),1)]),(0,n._)("div",X,[Q,(0,n._)("p",null,(0,r.zw)(this.loggedGroupJourneys.length?this.loggedGroupJourneys.length:0),1)])])]))],64)}var te=o(4161),oe=o(7296),se=o(7100),ne={components:{VueSpeedometer:oe.ZP,Datepicker:se.Z},data(){return{journeyArray:[],highlightUserID:null,loggedUserData:null,loggedUserJourneys:[],filteredDatabyDate:[],currTab:"Tab1",fromDate:null,toDate:null,groupID:null,userID:null,loggedGroupData:[],loggedGroupJourneys:[],cumulativeGroupJourneys:[],totalGroupCo2Output:0,totalGroupDistance:0}},methods:{logDates(){this.filteredDatabyDate=this.loggedUserJourneys.filter((e=>{const t=new Date(e.journeyDate);return console.log(t),t>=this.fromDate&&t<=this.toDate})),console.log(this.filteredDatabyDate),console.log("From Date: "+this.fromDate),console.log("From Date: "+this.toDate)}},async created(){try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:3000/api/protected",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();this.userID=e.userID,console.log("I'm in dashboard userID: "+this.userID)}else alert("Auth failed")}catch(e){console.log(e.message)}console.log(this.userID),this.highlightUserID=this.userID,this.groupID="1";try{const e=await te.Z.get("http://localhost:3000/getJourneys"),t=e.data;console.log(t),this.loggedUserJourneys=t.filter((e=>e.userID===this.highlightUserID));let o=await te.Z.get("http://localhost:3000/users");const s=o.data;console.log(s),this.loggedGroupJourneys=s.filter((e=>e.groupID===this.groupID));let n=s.filter((e=>e.userID===this.userID));this.groupID=n[0].groupID,console.log(this.groupID),console.log(this.loggedGroupJourneys);let r=s.filter((e=>e.groupID===this.groupID));console.log(r);const l=t.filter((e=>{const t=s.find((t=>t.userID===e.userID));return t&&t.groupID===this.groupID}));this.loggedGroupJourneys=l,console.log(this.loggedGroupJourneys),this.cumulativeGroupJourneys=l.reduce(((e,t)=>{const o=e.findIndex((e=>e.userID===t.userID));return-1===o?e.push({userID:t.userID,co2Output:t.co2Output,distance:t.distance}):(e[o].co2Output+=t.co2Output,e[o].distance+=t.distance),e}),[]),console.log(this.cumulativeGroupJourneys),this.cumulativeGroupJourneys.forEach((e=>{const t=s.find((t=>t.userID===e.userID));t&&(e.username=t.username)})),console.log(this.cumulativeGroupJourneys);let a=0;for(let d=0;d<this.cumulativeGroupJourneys.length;d++)a+=this.cumulativeGroupJourneys[d].co2Output;let i=0;for(let d=0;d<this.cumulativeGroupJourneys.length;d++)i+=this.cumulativeGroupJourneys[d].distance;this.totalGroupDistance=i,this.totalGroupCo2Output=a,console.log(this.totalGroupCo2Output),this.filteredDatabyDate=this.loggedUserJourneys;let u=t.reduce(((e,t)=>{const o=e.findIndex((e=>e.userID===t.userID));return-1===o?e.push({userID:t.userID,co2Output:t.co2Output,distance:t.distance}):(e[o].co2Output+=t.co2Output,e[o].distance+=t.distance),e}),[]);console.log(u),u=u.sort(((e,t)=>e.co2Output-t.co2Output));let c=u.find((e=>e.userID==this.userID));this.loggedUserData=c,console.log(this.loggedUserData),this.journeyArray=u}catch(e){console.error(e)}},mounted(){console.log("try to dieeeee")}},re=o(89);const le=(0,re.Z)(ne,[["render",ee],["__scopeId","data-v-69354a8f"]]);var ae=le,ie=o(9242);const ue={class:"input-boxes"},ce=(0,n._)("table",null,[(0,n._)("tr",null,[(0,n._)("td",null,[(0,n._)("input",{type:"text",id:"OriginBox",name:"OriginBox",placeholder:"Origin"})]),(0,n._)("td",null,[(0,n._)("input",{type:"text",id:"DestinationBox",name:"DestinationBox",placeholder:"Destination"})]),(0,n._)("td",null,[(0,n._)("button",{type:"submit"},"Search")])])],-1),de=[ce],ge=(0,n._)("head",null,[(0,n._)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"})],-1),pe={id:"open-div"},he={id:"top-bar-width"},me={id:"my-box"},ye={id:"box1"},ve={id:"box1innerOutter"},_e={id:"box1inner"},we=(0,n.uE)('<input type="text" id="toFrom" name="toFrom" value="Journey Name" placeholder="Enter A Name For Journey"><div class="inputLabelContainer"><div class="label">Distance (Km):</div><div><input id="distance" type="number"></div><div class="label">Date:</div><div><input id="date" type="date"></div><div class="label">Emissions (Kg):</div><div><input type="number" id="emissions"></div><div class="label">Duration:</div><div><input type="time" id="duration"></div></div>',2),fe={class:"box1Buttons"},be={id:"clone"},De=(0,n._)("span",null,"−",-1),Ie=[De],ke=(0,n._)("p",null,"Make sure to select a mode of transprot.",-1),Se={id:"box2"},Ge=(0,n._)("div",{class:"radioButtons"},[(0,n._)("div",{class:"row1"},[(0,n._)("input",{label:"Plane",type:"radio",name:"mode",value:"Plane",id:"planeButton"}),(0,n._)("input",{label:"Car",type:"radio",name:"mode",value:"Car",id:"carButton"}),(0,n._)("input",{label:"Transit",type:"radio",name:"mode",value:"Transit",id:"transitButton"}),(0,n._)("input",{label:"Walk",type:"radio",name:"mode",value:"Walk",id:"walkButton"})]),(0,n._)("div",{class:"row2",id:"row2",style:{display:"flex"}},[(0,n._)("input",{type:"radio",name:"size",id:"card",value:"small_car"}),(0,n._)("label",{for:"card"},[(0,n._)("i",{class:"fas fa-car","aria-hidden":"true",style:{"font-size":"2vw"}}),(0,n._)("span",null,"Small")]),(0,n._)("input",{type:"radio",name:"size",id:"cash",value:"average_car"}),(0,n._)("label",{for:"cash"},[(0,n._)("i",{class:"fas fa-car","aria-hidden":"true",style:{"font-size":"2.5vw"}}),(0,n._)("span",null,"Average")]),(0,n._)("input",{type:"radio",name:"size",id:"other",value:"large_car"}),(0,n._)("label",{for:"other"},[(0,n._)("i",{class:"fas fa-car","aria-hidden":"true",style:{"font-size":"3vw"}}),(0,n._)("span",null,"Large")]),(0,n._)("input",{type:"radio",name:"size",id:"test",value:"custom"}),(0,n._)("label",{for:"test"},[(0,n._)("i",{class:"fas fa-keyboard","aria-hidden":"true",style:{"font-size":"30px"}}),(0,n._)("span",null,"Custom")])]),(0,n._)("div",{class:"row3",id:"row3"},[(0,n._)("input",{label:"Diesel",type:"radio",name:"fuleType",value:"diesel"}),(0,n._)("input",{label:"Petrol",type:"radio",name:"fuleType",value:"petrol"}),(0,n._)("input",{label:"Hybrid",type:"radio",name:"fuleType",value:"hybrid"}),(0,n._)("input",{label:"Eletric",type:"radio",name:"fuleType",value:"electric"})])],-1),Me=(0,n._)("tr",null,[(0,n._)("td",null,[(0,n._)("input",{type:"text",id:"dvla-input",name:"dvla-input",placeholder:"BD51 SMR",maxlength:"8"}),(0,n._)("br")]),(0,n._)("td",null,[(0,n._)("button",{id:"dvla-submit-button",type:"submit"},"Submit")])],-1),Te=(0,n._)("tr",null,[(0,n._)("td",null,[(0,n._)("div",{id:"dvlaError"},[(0,n._)("p")])])],-1),Ce=[Me,Te],Oe=(0,n.uE)('<div id="box3"><div class="chart"><div class="legend"><div class="legend-item"></div></div><div class="row"><div class="label">Custom</div><div class="bar car"></div><div class="value"></div></div><div class="row"><div class="label">Car</div><div class="bar bus"></div><div class="value"></div></div><div class="row"><div class="label">Transit</div><div class="bar train"></div><div class="value"></div></div><div class="row"><div class="label">Walk‎ </div><div class="bar bicycle"></div><div class="value"></div></div><div class="scale-line"></div><div class="scale"><div class="scale-tick"></div><div class="scale-tick-label">0</div><div class="scale-tick"></div><div class="scale-tick-label">100</div><div class="scale-tick"></div><div class="scale-tick-label">200</div><div class="scale-tick"></div><div class="scale-tick-label">300</div><div class="scale-tick"></div><div class="scale-tick-label">400</div></div></div></div>',1),xe=(0,n._)("section",{id:"map"},null,-1);function Ee(e,t,o,s,r,l){const a=(0,n.up)("center");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",ue,[(0,n._)("form",{onSubmit:t[0]||(t[0]=(0,ie.withModifiers)(((...e)=>l.submitForm&&l.submitForm(...e)),["prevent"]))},de,32)]),ge,(0,n._)("div",pe,[(0,n._)("button",{id:"open-button",onClick:t[1]||(t[1]=(...e)=>l.open&&l.open(...e))},"^")]),(0,n._)("div",he,[(0,n._)("button",{id:"close-button",onClick:t[2]||(t[2]=(...e)=>l.close&&l.close(...e))},"v")]),(0,n._)("div",me,[(0,n._)("div",ye,[(0,n._)("div",ve,[(0,n._)("div",_e,[we,(0,n.Wm)(a,null,{default:(0,n.w5)((()=>[(0,n._)("div",fe,[(0,n._)("button",{id:"log-route",type:"submit",onClick:t[3]||(t[3]=(...e)=>l.logRoute&&l.logRoute(...e))},"Log This Route"),(0,n._)("button",{id:"show-directions",type:"submit",onClick:t[4]||(t[4]=(...e)=>l.hideLeftBox&&l.hideLeftBox(...e))},"Directions")])])),_:1})]),(0,n._)("div",be,[(0,n._)("button",{id:"cloneButton",onClick:t[5]||(t[5]=(...e)=>l.cloneButtonClose&&l.cloneButtonClose(...e))},Ie),ke])])]),(0,n._)("div",Se,[(0,n.Wm)(a,null,{default:(0,n.w5)((()=>[Ge,(0,n._)("form",{onSubmit:t[6]||(t[6]=(0,ie.withModifiers)(((...e)=>l.submitDvlaForm&&l.submitDvlaForm(...e)),["prevent"])),id:"reg-form"},Ce,32)])),_:1})]),Oe]),xe],64)}function Ue(e,t,o){const s={small_car:{diesel:.13989414,petrol:.14652,hybrid:.10332,electric:0},large_car:{diesel:.20953414,petrol:.27639,hybrid:.15491,electric:0},average_car:{diesel:.17082414,petrol:.17048,hybrid:.12004,electric:0}},n=s[e][t],r=n*o;return r}function Be(e,t){const o={average_local_bus:.0965,coach:.02733,national_rail:.03549,international_rail:.00446,tram_and_light_rail:.02861,london_underground:.02781,BUS:.0965,CABLE_CAR:0,COMMUTER_TRAIN:.03549,FERRY:0,FUNICULAR:0,GONDOLA_LIFT:0,HEAVY_RAIL:.03549,HIGH_SPEED_TRAIN:.03549,INTERCITY_BUS:.0965,METRO_RAIL:.02861,MONORAIL:.02861,OTHER:0,RAIL:.03549,SHARE_TAXI:0,SUBWAY:.02781,TRAM:.02861,TROLLEYBUS:.02861},s=o[e],n=s*t;return n}function Ae(e,t){const o={domestic_uk_average:.24587,short_haul_uk_average:.15353,long_haul_uk_average:.19309,international_none_uk_average:.18362},s=o[e],n=s*t;return n}console.log("TEST",Ue("average_car","diesel",100)),console.log("TEST",Be("national_rail",100)),console.log("TEST",Ae("long_haul_uk_average",5e3));var je={name:"MyComponent",data(){return{lat:"",lng:"",map:null,box:null,selected:""}},created(){},mounted(){let e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA5K5yoDu6AnALOdV-VzcINZg1bKXH5-TA&libraries=places",document.body.appendChild(e),e.onload=()=>{new google.maps.places.Autocomplete(document.getElementById("latBox")),new google.maps.places.Autocomplete(document.getElementById("lngBox")),new google.maps.places.Autocomplete(document.getElementById("OriginBox")),new google.maps.places.Autocomplete(document.getElementById("DestinationBox"));new google.maps.DirectionsService;this.displayMap(53.400002,-2.983333,10);var e=document.getElementById("row2");e.style.display="none";var t=document.getElementById("row3");t.style.display="none"};const t=document.querySelectorAll('.radioButtons input[type="radio"]');t.forEach((e=>{e.addEventListener("change",(()=>{const e=document.querySelector('.row1 input[type="radio"]:checked'),t=document.querySelector('.row2 input[type="radio"]:checked'),o=document.querySelector('.row3 input[type="radio"]:checked');if(e&&"Car"===e.value?document.querySelector(".row2").style.display="flex":(document.querySelectorAll('.row2 input[type="radio"]').forEach((e=>{e.checked=!1})),document.querySelector(".row2").style.display="none"),t&&"custom"!==t.value){document.querySelector(".row3").style.display="flex";var s=document.getElementById("reg-form");s.style.display="none"}else if(t&&"custom"===t.value){document.querySelector(".row3").style.display="none",document.querySelectorAll('.row3 input[type="radio"]').forEach((e=>{e.checked=!1}));s=document.getElementById("reg-form");s.style.display="block"}e&&"Car"!==e.value&&(document.querySelector(".row3").style.display="none",document.querySelectorAll('.row3 input[type="radio"]').forEach((e=>{e.checked=!1})));var n={mode:"",carType:"",fuleType:"",validRegNumb:""};if(e&&"Plane"===e.value){var r=n;r.mode=e.value}if(e&&"Transit"===e.value){r=n;r.mode=e.value;var l=document.getElementById("duration");const t=Math.round(durationInMinutes2),o=Math.floor(t/60),s=t%60,c=`${o.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;l.value=c;var a=document.getElementById("distance"),i=parseFloat(transitDistance.replace("km",""));a.value=i;var u=document.getElementById("emissions");u.value=transitCo2Output.toFixed(3);const d=instructions_public_transport,g=document.querySelector("#clone p");g.innerHTML=d}if(e&&"Walk"===e.value){r=n;r.mode=e.value}if(e&&t&&o){r={mode:e.value,carType:t.value,fuleType:o.value,validRegNumb:""};var c=parseFloat(carDistance.replace("km","")),d=Ue(t.value,o.value,c);l=document.getElementById("duration");const s=Math.round(durationInMinutes1),n=Math.floor(s/60),i=s%60,g=`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`;l.value=g;a=document.getElementById("distance");a.value=c;u=document.getElementById("emissions");u.value=d.toFixed(3);const p=instructions_car,h=document.querySelector("#clone p");h.innerHTML=p}return console.log(r),r}))}))},methods:{displayMap(e,t,o){let s=document.createElement("script");s.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA5K5yoDu6AnALOdV-VzcINZg1bKXH5-TA",document.body.appendChild(s),s.onload=()=>{this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:e,lng:t},zoom:o,mapTypeControl:!1,disableDefaultUI:!0});new google.maps.Marker({position:{lat:e,lng:t},map:map,title:"Your Current Location"})}},logRoute(){var e=document.getElementById("toFrom").value,t=document.getElementById("date").value,o=document.getElementById("duration").value,s=document.getElementById("distance").value,n=document.getElementById("emissions").value;console.log("DATA LOGGED! ","Journey Name: ",e,"Journey date in DD/MM/YY: ",t,"Journey Duration in HH:MM: ",o," distance: ",s," Journey Emissions Total in Kg: ",n)},submitDvlaForm(e){var t=document.getElementById("dvlaError"),o=document.getElementById("dvla-input").value;if(/^[A-Z]{2}[0-9]{2}\s?[A-Z]{3}$/.test(o))console.log(`${o} is a valid UK number plate!`),t.textContent="",e.fuleType="",e.carType="",e.validRegNumb=o,console.log(e);else{var s=`${o} is not a valid UK number plate.`;console.log(s);var n=document.getElementById("dvla-input");n.value="",t.textContent=s,t.classList.remove("fade-out"),setTimeout((()=>{t.classList.add("fade-out")}),2e3)}return e},barChartUpdate(e,t,o,s){var n=e,r=t,l=o,a=s,i=document.querySelector(".car"),u=document.querySelector(".bus"),c=document.querySelector(".train"),d=document.querySelector(".bicycle"),g=document.querySelector(".car + .value"),p=document.querySelector(".bus + .value"),h=document.querySelector(".train + .value"),m=document.querySelector(".bicycle + .value");i.style.width=n+"px",u.style.width=r+"px",c.style.width=l+"px",d.style.width=a+"px",g.textContent=n+" g/km",p.textContent=r+" g/km",h.textContent=l+" g/km",m.textContent="0 g/km"},submitForm(){const e=(new Date).toISOString().substr(0,10);document.getElementById("date").value=e,this.opendiv=document.getElementById("open-div"),this.openButton=document.getElementById("open-button"),this.box=document.getElementById("my-box"),this.closeButton=document.getElementById("close-button"),this.box.style.display="block",this.closeButton.style.display="block",this.opendiv.style.display="none",this.openButton.style.display="none";let t=document.getElementById("OriginBox").value,s=document.getElementById("DestinationBox").value;if(document.getElementById("toFrom").value=t+" → "+s,t&&s){let e=new google.maps.Geocoder;e.geocode({address:t},(function(t,n){if(n==google.maps.GeocoderStatus.OK){let n=t[0].geometry.location;console.log(n),e.geocode({address:s},(function(e,t){if(t==google.maps.GeocoderStatus.OK){let t=e[0].geometry.location,s=new google.maps.Map(document.getElementById("map"),{zoom:8,center:n,mapTypeControl:!1}),r=(new google.maps.Marker({position:n,map:s}),new google.maps.Marker({position:t,map:s}),{strokeColor:"#ffaa1c",strokeOpacity:1,strokeWeight:4,clickable:!0}),l={strokeColor:"#ffe733",strokeOpacity:1,strokeWeight:4},a=new google.maps.DirectionsService,i=new google.maps.DirectionsRenderer({polylineOptions:r}),u=new google.maps.DirectionsService,c=new google.maps.DirectionsRenderer({polylineOptions:l}),d={origin:n,destination:t,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC},g={origin:n,destination:t,travelMode:google.maps.TravelMode.TRANSIT,unitSystem:google.maps.UnitSystem.METRIC};u.route(g,(function(e,t){if(t==google.maps.DirectionsStatus.OK){var n=e.routes[0].legs[0].steps;o.g.instructions_public_transport="Public Transport Directions: <br>",o.g.transitCo2Output=0;for(var r=0;r<n.length;r++){var l=n[r].distance.text,a=n[r].distance.value,i=n[r].travel_mode;if("TRANSIT"===i){var u=n[r].transit.line.vehicle.type;console.log("Leg "+(r+1)+" distance: "+l+" (travel mode: "+u+")"),transitCo2Output+=Be(u,a/1e3)}else console.log("Leg "+(r+1)+" distance: "+l+" (travel mode: "+i+")");console.log("Public transport directions",n[r].instructions),instructions_public_transport+=r+1+") "+n[r].instructions+"<br>"}console.log("Transport emissions total) = ",transitCo2Output),c.setDirections(e),c.setMap(s);var d=e.routes[0].legs[0].duration.value;o.g.durationInMinutes2=d/60,console.log("transitDistance (transport total time) = ",durationInMinutes2),o.g.transitDistance=e.routes[0].legs[0].distance.text,console.log("transitDistance (transit total) = ",transitDistance);transitDistance;const t=parseFloat(transitDistance.replace("km",""));var g=1e3*transitCo2Output/t;console.log("transit co2 / distance=",g),console.log("TESTTT")}else console.log("Directions request failed: "+t)})),a.route(d,(function(e,t){if(t==google.maps.DirectionsStatus.OK){var n=e.routes[0].legs[0].steps;o.g.instructions_car="Car Directions: <br>";for(var r=0;r<n.length;r++)console.log("Car directions",n[r].instructions),instructions_car+=r+1+") "+n[r].instructions+"<br>";i.setDirections(e),i.setMap(s),o.g.carDistance=e.routes[0].legs[0].distance.text,console.log("carDistance (car total) = ",carDistance);var l="Distance: "+carDistance,a=e.routes[0].legs[0].duration.value;o.g.durationInMinutes1=a/60,console.log("carDistance (car total time) = ",durationInMinutes1);var u=document.getElementById("car-distance");u.innerHTML=l,console.log("transit co2 / distance=",138.4)}else console.log("Directions request failed: "+t)}))}else console.log("Geocode failed for destination address: "+t)}))}else console.log("Geocode failed for origin address: "+n)}))}console.log("TEST",transitCo2Average),this.barChartUpdate(0,138.4,transitCo2Average,3)},hideLeftBox(){var e=document.getElementById("box1inner");e.style.display="none";var t=document.getElementById("clone");t.style.display="block"},close(){this.box.style.display="none",this.closeButton.style.display="none",this.opendiv.style.display="block",this.openButton.style.display="block"},open(){this.opendiv.style.display="none",this.openButton.style.display="none",this.box.style.display="block",this.closeButton.style.display="block"},cloneButtonClose(){var e=document.getElementById("clone");e.style.display="none";var t=document.getElementById("box1inner");t.style.display="block"}}};const Ne=(0,re.Z)(je,[["render",Ee]]);var Re=Ne;const Le=e=>((0,n.dD)("data-v-7fd81cb0"),e=e(),(0,n.Cn)(),e),Pe={ref:"confetti",class:"confetti-canvas"},qe={key:0},ze=Le((()=>(0,n._)("p",null,"Loading... (u gotta be patient)",-1))),Fe=[ze],Je={key:1},He=Le((()=>(0,n._)("span",{id:"eco-bold-green"},"eco-friendly",-1))),Ye=Le((()=>(0,n._)("span",{id:"eco-bold-green"},"eco-friendly",-1))),We={class:"form-container"},Ke={class:"register-form"},Ze={key:0,class:"error-message"},$e={class:"error-text"},Ve={key:1,class:"succ-message"},Xe={class:"succ-text"},Qe=Le((()=>(0,n._)("label",{for:"register-username"},"Username:",-1))),et=Le((()=>(0,n._)("label",{for:"register-email"},"Email:",-1))),tt=Le((()=>(0,n._)("label",{for:"register-password"},"Password:",-1))),ot=Le((()=>(0,n._)("button",{type:"submit"},"Register",-1))),st={class:"login-form"},nt={key:0,class:"error-message"},rt={class:"error-text"},lt=Le((()=>(0,n._)("label",{for:"login-username"},"Username:",-1))),at=Le((()=>(0,n._)("label",{for:"login-password"},"Password:",-1))),it=Le((()=>(0,n._)("button",{type:"submit"},"Login",-1))),ut={key:2},ct={style:{color:"green","font-weight":"600"}},dt=Le((()=>(0,n._)("br",null,null,-1))),gt={key:0},pt=Le((()=>(0,n._)("b",{style:{color:"green","font-weight":"600"}},"Group",-1))),ht=Le((()=>(0,n._)("br",null,null,-1))),mt={key:1},yt={style:{color:"green","font-weight":"600"}},vt=Le((()=>(0,n._)("h1",null,[(0,n.Uk)("Eco-"),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"Groups"),(0,n.Uk)("!")],-1))),_t=Le((()=>(0,n._)("p",null,[(0,n.Uk)("Wanna work in a team to make this world a better place? By working in a team, you can make a real difference and create a brighter, cleaner, and more sustainable future. Join a "),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"Group"),(0,n.Uk)(" now and be part of the solution!")],-1))),wt={class:"login-form"},ft=Le((()=>(0,n._)("p",null,[(0,n.Uk)("Not yet in the "),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"Group"),(0,n.Uk)("? "),(0,n._)("br"),(0,n.Uk)(" Create one!")],-1))),bt=Le((()=>(0,n._)("button",{type:"submit"},"Create a group!",-1))),Dt={key:0},It={class:"login-form"},kt=Le((()=>(0,n._)("p",null,[(0,n.Uk)("Wanna join a already existing "),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"Group"),(0,n.Uk)("? "),(0,n._)("br"),(0,n.Uk)(" Join one!")],-1))),St=Le((()=>(0,n._)("button",{type:"submit"},"Join a group!",-1))),Gt={key:0},Mt=Le((()=>(0,n._)("div",{class:"globalRanking-table-title"},[(0,n._)("h2",null,[(0,n.Uk)("Your "),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"Eco"),(0,n.Uk)("-friends!")])],-1))),Tt=Le((()=>(0,n._)("br",null,null,-1))),Ct={key:2},Ot=Le((()=>(0,n._)("p",null,"Join a group to see your friends!",-1))),xt=[Ot],Et={key:3},Ut={class:"globalRankingTable"},Bt=Le((()=>(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"Rank"),(0,n._)("th",null,"Nickname")])],-1))),At={key:4},jt=Le((()=>(0,n._)("h1",null,[(0,n.Uk)("Leave your "),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"group"),(0,n.Uk)(),(0,n._)("br")],-1))),Nt=Le((()=>(0,n._)("p",null,"We sad to hear you want to leave. Hope to see you soon!",-1))),Rt={key:0},Lt=Le((()=>(0,n._)("h1",null,[(0,n.Uk)("Change your green "),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"password")],-1))),Pt=Le((()=>(0,n._)("p",null,[(0,n.Uk)("It takes "),(0,n._)("b",{style:{color:"green","font-weight":"600"}},"zero"),(0,n.Uk)(" Co2 to change your password ;)"),(0,n._)("br")],-1))),qt={class:"login-form"},zt=Le((()=>(0,n._)("button",{type:"submit"},"Change your password",-1)));function Ft(e,t,o,s,l,a){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("canvas",Pe,null,512),this.loading?((0,n.wg)(),(0,n.iD)("div",qe,Fe)):(0,n.kq)("",!0),l.loggedIn||this.loading?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",Je,[(0,n._)("div",null,[(0,n.wy)((0,n._)("h1",null,[(0,n.Uk)("Create an account to join our "),He,(0,n.Uk)(" family! :)")],512),[[ie.vShow,l.showRegisterForm]]),(0,n.wy)((0,n._)("h1",null,[(0,n.Uk)("Login in to join our amazing "),Ye,(0,n.Uk)(" family! :)")],512),[[ie.vShow,!l.showRegisterForm]]),(0,n._)("div",We,[(0,n.wy)((0,n._)("div",Ke,[(0,n._)("form",{onSubmit:t[4]||(t[4]=(0,ie.withModifiers)(((...e)=>a.handleRegisterSubmit&&a.handleRegisterSubmit(...e)),["prevent"]))},[l.registerErrorMsg?((0,n.wg)(),(0,n.iD)("div",Ze,[(0,n._)("p",$e,(0,r.zw)(l.registerErrorMsg),1)])):(0,n.kq)("",!0),l.registerSuccMsg?((0,n.wg)(),(0,n.iD)("div",Ve,[(0,n._)("p",Xe,(0,r.zw)(l.registerSuccMsg),1)])):(0,n.kq)("",!0),(0,n._)("div",null,[Qe,(0,n.wy)((0,n._)("input",{type:"text",id:"register-username",ref:"registerUsernameInput","onUpdate:modelValue":t[0]||(t[0]=e=>l.registerUsername=e),required:""},null,512),[[ie.vModelText,l.registerUsername]])]),(0,n._)("div",null,[et,(0,n.wy)((0,n._)("input",{type:"email",id:"register-email",ref:"registerEmailInput","onUpdate:modelValue":t[1]||(t[1]=e=>l.registerEmail=e),required:""},null,512),[[ie.vModelText,l.registerEmail]])]),(0,n._)("div",null,[tt,(0,n.wy)((0,n._)("input",{type:"password",id:"register-password",ref:"registerPasswordInput","onUpdate:modelValue":t[2]||(t[2]=e=>l.registerPassword=e),required:""},null,512),[[ie.vModelText,l.registerPassword]])]),ot,(0,n._)("button",{class:"toggle-btn",onClick:t[3]||(t[3]=(...e)=>a.toggleShowRegisterForm&&a.toggleShowRegisterForm(...e))},"Already have an eco-friendly account?")],32)],512),[[ie.vShow,l.showRegisterForm]]),(0,n.wy)((0,n._)("div",st,[l.loginErrorMsg?((0,n.wg)(),(0,n.iD)("div",nt,[(0,n._)("p",rt,(0,r.zw)(l.loginErrorMsg),1)])):(0,n.kq)("",!0),(0,n._)("form",{onSubmit:t[8]||(t[8]=(0,ie.withModifiers)(((...e)=>a.handleLoginSubmit&&a.handleLoginSubmit(...e)),["prevent"]))},[(0,n._)("div",null,[lt,(0,n.wy)((0,n._)("input",{type:"text",id:"login-username",ref:"loginUsernameInput","onUpdate:modelValue":t[5]||(t[5]=e=>l.loginUsername=e),required:""},null,512),[[ie.vModelText,l.loginUsername]])]),(0,n._)("div",null,[at,(0,n.wy)((0,n._)("input",{type:"password",id:"login-password",ref:"loginPasswordInput","onUpdate:modelValue":t[6]||(t[6]=e=>l.loginPassword=e),required:""},null,512),[[ie.vModelText,l.loginPassword]])]),it,(0,n._)("button",{class:"toggle-btn",onClick:t[7]||(t[7]=(...e)=>a.toggleShowRegisterForm&&a.toggleShowRegisterForm(...e))},"Ready to register?")],32)],512),[[ie.vShow,!l.showRegisterForm]])])])])),l.loggedIn?((0,n.wg)(),(0,n.iD)("div",ut,[(0,n._)("p",null,[(0,n.Uk)("Welcome back "),(0,n._)("b",ct,(0,r.zw)(l.username),1),(0,n.Uk)("! "),dt,(0,n.Uk)(" Let's plan another eco-friendly journey! ;)")]),l.groupName?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",gt,[(0,n.Uk)("You don't belong to a "),pt,(0,n.Uk)("! "),ht])),l.groupName?((0,n.wg)(),(0,n.iD)("p",mt,[(0,n.Uk)("You belong to the "),(0,n._)("b",yt,(0,r.zw)(l.groupName),1),(0,n.Uk)(" Group")])):(0,n.kq)("",!0),(0,n._)("button",{id:"logout",onClick:t[9]||(t[9]=(...e)=>a.handleLogout&&a.handleLogout(...e))},"Logout"),vt,_t,(0,n._)("div",wt,[ft,(0,n._)("form",{onSubmit:t[11]||(t[11]=(0,ie.withModifiers)(((...e)=>a.createGroup&&a.createGroup(...e)),["prevent"]))},[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=e=>l.newGroupName=e),placeholder:"Name of your new group",required:""},null,512),[[ie.vModelText,l.newGroupName]]),bt],32),l.newGroupMessage?((0,n.wg)(),(0,n.iD)("p",Dt,(0,r.zw)(l.newGroupMessage),1)):(0,n.kq)("",!0)]),(0,n._)("div",It,[kt,(0,n._)("form",{onSubmit:t[13]||(t[13]=(0,ie.withModifiers)(((...e)=>a.joinGroup&&a.joinGroup(...e)),["prevent"]))},[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=e=>l.joinGroupName=e),placeholder:"Name of the group",required:""},null,512),[[ie.vModelText,l.joinGroupName]]),St],32),l.joinGroupMessage?((0,n.wg)(),(0,n.iD)("p",Gt,(0,r.zw)(l.joinGroupMessage),1)):(0,n.kq)("",!0)]),Mt,Tt,l.groupName?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",Ct,xt)),l.groupName?((0,n.wg)(),(0,n.iD)("div",Et,[(0,n._)("table",Ut,[Bt,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(this.groupFriends,((e,t)=>((0,n.wg)(),(0,n.iD)("tr",{key:t,class:(0,r.C_)({"highlight-row":e.userID===this.userID})},[(0,n._)("td",null,(0,r.zw)(t+1),1),(0,n._)("td",null,(0,r.zw)(e.username),1)],2)))),128))])])])):(0,n.kq)("",!0),l.groupName?((0,n.wg)(),(0,n.iD)("div",At,[jt,(0,n._)("button",{id:"logout",onClick:t[14]||(t[14]=(...e)=>a.leaveGroup&&a.leaveGroup(...e))},"Leave"),Nt,l.leaveGroupMessage?((0,n.wg)(),(0,n.iD)("p",Rt,(0,r.zw)(l.leaveGroupMessage),1)):(0,n.kq)("",!0)])):(0,n.kq)("",!0),Lt,Pt,(0,n._)("div",qt,[(0,n._)("form",{onSubmit:t[16]||(t[16]=(0,ie.withModifiers)(((...e)=>a.handleChangePassword&&a.handleChangePassword(...e)),["prevent"]))},[(0,n.wy)((0,n._)("input",{type:"password",placeholder:"You new amazing password",id:"change-password",ref:"changePasswordInput","onUpdate:modelValue":t[15]||(t[15]=e=>l.changePassword=e),required:""},null,512),[[ie.vModelText,l.changePassword]]),zt],32)])])):(0,n.kq)("",!0)])}var Jt=o(814),Ht=o(2492),Yt=o.n(Ht),Wt={data(){return{registerUsername:"",registerEmail:"",registerPassword:"",loginUsername:"",loginPassword:"",changePassword:"",loggedIn:!1,username:"",userID:null,message:"",loading:!1,loginErrorMsg:"",registerErrorMsg:"",registerSuccMsg:"",showRegisterForm:!0,newGroupName:"",newGroupMessage:"",joinGroupName:"",joinGroupMessage:"",inGroup:!1,groupName:"",groupID:null,groupFriends:[],leaveGroupMessage:""}},methods:{toggleShowRegisterForm(){this.showRegisterForm=!this.showRegisterForm},handleRegisterSubmit(){if(!(this.registerPassword.length>=6&&/[A-Z]/.test(this.registerPassword)&&/\d/.test(this.registerPassword)))return this.registerErrorMsg="Oh no! You password is not secure enough! It must have at least 6 letters, 1 digit and 1 uppercase letter :)",void(this.registerPassword="");console.log("Password meets requirements"),fetch("http://localhost:3000/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.registerUsername,email:this.registerEmail,password:this.registerPassword})}).then((e=>{if(console.log(e),e.ok)return e.json().then((()=>{this.registerEmail="",this.registerPassword="",this.registerUsername="",this.registerErrorMsg="",this.startConfetti(),this.registerSuccMsg="Congratulations! You are one step closer to safe the planet from Co2! :)"}));this.registerSuccMsg="",this.registerErrorMsg="Username already exists.",this.registerUsername=""})).catch((e=>{alert(`Error: ${e.message}`)}))},handleLoginSubmit(){fetch("https://kacper-ecojourney2.onrender.com:3000/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.loginUsername,password:this.loginPassword})}).then((e=>e.ok?(this.loggedIn=!0,this.username=this.loginUsername,this.loginUsername="",this.loginPassword="",e.json()):e.json())).then((e=>{this.loginErrorMsg=e.message,console.log(e),localStorage.setItem("token",e.token),console.log(localStorage.getItem("token")),this.$emit("checkLoggedInApp"),console.log("6999"),this.loginPassword="",this.$router.push("/")})).catch((e=>{console.log(e)}))},handleChangePassword(){if(!(this.changePassword.length>=6&&/[A-Z]/.test(this.changePassword)&&/\d/.test(this.changePassword))){let e="You password is not secure enough! It must have at least 6 letters, 1 digit and 1 uppercase letter :)";return this.showMessage("Oh no!",e,"warning"),void(this.changePassword="")}console.log("Password meets requirements"),fetch("http://localhost:3000/users/changePassword",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userID:this.userID,password:this.changePassword})}).then((e=>(console.log(e),e.ok?e.json().then((e=>{console.log(e),this.startConfetti(),this.showMessage("Success!","Your password has been successfully changed!","success"),this.changePassword=""})):e.json().then((e=>{this.showMessage("Oh no!",e.message,"error"),console.log(e),this.changePassword=""}))))).catch((e=>{alert(`Error: ${e.message}`)}))},handleLogout(){this.$emit("handleLogoutApp"),fetch("http://localhost:3000/users/logout",{method:"POST",credentials:"include"}).then((e=>{e.ok&&(localStorage.removeItem("token"),this.loggedIn=!1,this.username="",this.loginErrorMsg="",this.registerErrorMsg="")})).catch((e=>{alert("error"),console.log(e)}))},async checkLoggedIn(){const e=localStorage.getItem("token");if(e)try{const t=await fetch("http://localhost:3000/api/protected",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();this.username=e.username,this.userID=e.userID,this.loggedIn=!0,console.log(e)}else alert("Auth failed")}catch(t){console.log(t.message)}else this.message="Authentication failed: Missing token"},async createGroup(){await fetch("http://localhost:3000/getGroups").then((e=>e.json())).then((async e=>{const t=e.some((e=>e.groupName===this.newGroupName.trim()));t?(this.showMessage("Try again!","Group name already exists.","warning"),this.newGroupName=""):await fetch("http://localhost:3000/createGroup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newGroupName:this.newGroupName.trim()})}).then((e=>e.ok?(this.newGroupMessage="Group "+this.newGroupName+" created successfully!",this.showMessage("Success! Group created!",this.newGroupMessage,"success"),this.newGroupName="",this.startConfetti(),e.json()):(this.newGroupMessage="An error occured. Try again later!",this.newGroupName="",e.json()))).then((e=>{console.log(e),this.newGroupMessage=e.message})).catch((e=>{this.newGroupMessage="An error occured. Try again later!",this.newGroupName="",console.log(e)}))}))},async joinGroup(){console.log(this.username),await fetch("http://localhost:3000/getGroups").then((e=>e.json())).then((async e=>{console.log(e);const t=e.some((e=>e.groupName===this.joinGroupName));if(t){const t=e.find((e=>e.groupName===this.joinGroupName)).groupID;console.log(t),console.log(this.username),await fetch("http://localhost:3000/joinGroup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({groupID:t,username:this.username})}).then((async e=>{if(e.ok){this.groupID=t,this.joinGroupMessage="You joined '"+this.joinGroupName+"' group!",this.showMessage("Success!",this.joinGroupMessage,"success"),this.groupName=this.joinGroupName,this.startConfetti(),this.joinGroupName="";const o=await te.Z.get("http://localhost:3000/users"),s=await o.data,n=await s.filter((e=>e.groupID==this.groupID));return this.groupFriends=n,console.log(o),console.log(s),console.log(n),e.json()}return e.json()})).then((e=>{console.log(e),e.error&&(this.joinGroupMessage=e.error)})).catch((e=>{this.joinGroupMessage="An error occured. Try again later!",this.joinGroupMessage="",console.log(e)}))}else this.joinGroupMessage="'"+this.joinGroupName+"' group doesn't exist",this.joinGroupName=""}))},async leaveGroup(){try{const e=await te.Z["delete"](`http://localhost:3000/joinGroup/${this.userID}`);console.log(e.data),this.leaveGroupMessage=e.data.message,this.groupID=null,this.groupName="",this.showMessage("You left your group!","Your eco-friends will miss you :(","warning")}catch(e){console.error(e),this.showMessage("Something went wrong","Try again later","error")}},startConfetti(){document.querySelector(".confetti-canvas").style.display="block";const e=new Jt.Z({target:this.$refs.confetti,max:80,size:1,animate:!0,props:["circle","square","triangle","line"],colors:[[255,0,0],[0,255,0],[0,0,255]],clock:25});e.render(),setTimeout((()=>{e.clear(),document.querySelector(".confetti-canvas").style.display="none"}),2e3)},showMessage(e,t,o){Yt().fire({title:e,text:t,icon:o,confirmButtonText:"OK"})}},async created(){this.loading=!0,await this.checkLoggedIn(),this.loading=!1,console.log("this.loggedIn: "+this.loggedIn),console.log("this.username: "+this.username),this.loginErrorMsg="";const e=await te.Z.get("http://localhost:3000/users"),t=await e.data,o=await t.find((e=>e.username==this.username));if(this.groupID=o.groupID,this.groupID){const e=await t.filter((e=>e.groupID==this.groupID));this.groupFriends=e,console.log(e)}if(this.userID=o.userID,this.groupID){const e=await te.Z.get("http://localhost:3000/getGroups"),t=await e.data;console.log(t),console.log(this.groupID);const o=await t.find((e=>e.groupID==this.groupID)).groupName;console.log(o),this.groupName=o}}};const Kt=(0,re.Z)(Wt,[["render",Ft],["__scopeId","data-v-7fd81cb0"]]);var Zt=Kt,$t={name:"App",components:{Dashboard:ae,JourneyPlanner:Re,Login:Zt},data(){return{logoutMsg:"Register/Login",loggedIn:!1,userID:null}},watch:{$route(e,t){console.log("WATCH"+e.path),e.path}},methods:{async checkLoggedInApp(){console.log("checkLoggedInApp");const e=localStorage.getItem("token");if(e)try{const t=await fetch("http://localhost:3000/api/protected",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();this.userID=e.userID,this.loggedIn=!0,this.logoutMsg="Profile",console.log("I'm in app userID: "+this.userID)}else alert("Auth failed")}catch(t){console.log(t.message)}else console.log("Authentication failed: Missing token")},handleLogoutApp(){console.log("handleLogoutApp"),this.userID=null,this.loggedIn=!1,this.logoutMsg="Register/Login"},async checkToken(){localStorage.getItem("token")?(await console.log(this.userID),await this.checkLoggedInApp(),await console.log(this.userID),console.log("SDFHBHSDFBHSDFchechtoken")):(this.$router.push("/login"),console.log("SDFAUYHSDFUSDFUnext"))}},created(){console.log("created"),this.checkToken()},routes:[{path:"/",name:"JourneyPlanner",component:Re},{path:"/dashboard",name:"Dashboard",component:ae},{path:"/login",name:"Login",component:Zt}]};const Vt=(0,re.Z)($t,[["render",m]]);var Xt=Vt,Qt=o(2483);const eo=[{path:"/",component:Re},{path:"/dashboard",component:ae},{path:"/login",component:Zt}],to=(0,Qt.p7)({history:(0,Qt.PO)(),routes:eo}),oo=(0,s.ri)(Xt);oo.use(to),oo.mount("#app")}},t={};function o(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=e,function(){var e=[];o.O=function(t,s,n,r){if(!s){var l=1/0;for(c=0;c<e.length;c++){s=e[c][0],n=e[c][1],r=e[c][2];for(var a=!0,i=0;i<s.length;i++)(!1&r||l>=r)&&Object.keys(o.O).every((function(e){return o.O[e](s[i])}))?s.splice(i--,1):(a=!1,r<l&&(l=r));if(a){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[s,n,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,r,l=s[0],a=s[1],i=s[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(i)var c=i(o)}for(t&&t(s);u<l.length;u++)r=l[u],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},s=self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(3595)}));s=o.O(s)})();
//# sourceMappingURL=app.d7cf17ca.js.map